<?xml version="1.0" ?>
<sdf version="1.7">
  <!-- Define o que é o robô -->
  <model name="wbr">
    <static>false</static> <!-- agora ele cai -->

    <!-- link: base_footprint -->
    <link name="base_footprint"/>
    
    <!-- link: chassi -->
    <link name="chassi">
      <pose relative_to="base_footprint">0 0 0 0 0 1.5708</pose>
      <inertial>
        <mass>14.7</mass>
        <inertia>
          <ixx>0.698</ixx>
          <iyy>0.593</iyy>
          <izz>0.803</izz>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyz>0.0</iyz>
        </inertia>
      </inertial>

      <collision name="chassi_collision">
      <pose>0.06 -0.125 0.08 0 0 0</pose>
        <geometry>
          <box>
            <size>0.355 0.37 0.18</size>
          </box>
        </geometry>
      </collision>

      <visual name="chassi_visual">
        <pose>0 0 0 1.5708 0 0</pose>
        <geometry>
          <mesh>
            <uri>model://wbr/meshes/Chassi_Tcc_2.stl</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh>
        </geometry>
        <material>
          <ambient>1 0 0 1</ambient>
          <diffuse>1 0 0 1</diffuse>
          <specular>0.8 0.8 0.8 1</specular>
          <emissive>0 0 0 1</emissive>
        </material>
      </visual>
    </link> 

    <!-- link: left_wheel -->
    <link name="left_wheel">
    <pose relative_to="chassi">-0.07 -0.142 -0.092 0 3.1415 0</pose>
      <inertial>
        <mass>5.81</mass>
        <inertia>
          <ixx>0.013</ixx>
          <iyy>0.013</iyy>
          <izz>0.020</izz>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyz>0.0</iyz>
        </inertia>
      </inertial>

      <collision name="left_wheel_collision">
        <pose>0.029500 0.000000 0.000000 0.000000 1.570800 0.000000</pose>
        <geometry>
          <cylinder>
            <radius>0.083</radius>
            <length>0.030</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>1.0</mu>
              <mu2>1.0</mu2>
            </ode>
          </friction>
        </surface>
      </collision>

      <visual name="left_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://wbr/meshes/motor.stl</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh>
        </geometry>
        <material>
          <ambient>0 0 0 1</ambient>
          <diffuse>0 0 0 1</diffuse>
          <specular>0.1 0.1 0.1 1</specular> 
          <emissive>0 0 0 1</emissive>
        </material>
      </visual>
    </link> 

    <!-- link: right_wheel -->
    <link name="right_wheel">
    <pose relative_to="chassi">0.2 -0.142 -0.092 0 0 0</pose>
      <inertial>
        <mass>5.81</mass>
        <inertia>
          <ixx>0.013</ixx>
          <iyy>0.013</iyy>
          <izz>0.020</izz>
          <ixy>0.0</ixy>
          <ixz>0.0</ixz>
          <iyz>0.0</iyz>
        </inertia>
      </inertial>

      <collision name="right_wheel_collision">
        <pose>0.029500 0.000000 0.000000 0.000000 1.570800 3.1415</pose>
        <geometry>
          <cylinder>
            <radius>0.083</radius>
            <length>0.030</length>
          </cylinder>
        </geometry>
        <surface>
          <friction>
            <ode>
              <mu>1.0</mu>
              <mu2>1.0</mu2>
            </ode>
          </friction>
        </surface>
      </collision>

      <visual name="right_wheel_visual">
        <geometry>
          <mesh>
            <uri>model://wbr/meshes/motor.stl</uri>
            <scale>0.001 0.001 0.001</scale>
          </mesh>
        </geometry>
        <material>
          <ambient>0 0 0 1</ambient>
          <diffuse>0 0 0 1</diffuse>
          <specular>0.1 0.1 0.1 1</specular> 
          <emissive>0 0 0 1</emissive>
        </material>
      </visual>
    </link> 

    <!-- joint: base_footprint -> chassi -->
    <joint name="joint_base_footprint_to_chassi" type="fixed">
      <parent>base_footprint</parent>
      <child>chassi</child>
    </joint>

    <!-- joint: chassi -> left_wheel -->
    <joint name="chassi_to_left_wheel" type="revolute">
      <parent>chassi</parent>
      <child>left_wheel</child>
      <axis>
        <xyz>1 0 0</xyz>
        <limit>
          <effort>50</effort> <!-- from <wheel_torque> in libgazebo_ros_diff_drive.so.-->
        </limit>
      </axis>
    </joint>

    <!-- joint: chassi -> right_wheel -->
    <joint name="chassi_to_right_wheel" type="revolute">
      <parent>chassi</parent>
      <child>right_wheel</child>
      <axis>
        <xyz>1 0 0</xyz>
        <limit>
          <effort>50</effort> <!-- from <wheel_torque> in libgazebo_ros_diff_drive.so.-->
        </limit>
      </axis>
    </joint>

    <!-- plugin: diff-drive -->
    <plugin filename="gz-sim-diff-drive-system" name="gz::sim::systems::DiffDrive">
      <!-- Remove <ros> tag. -->

      <!-- wheels -->
      <left_joint>chassi_to_left_wheel</left_joint>
      <right_joint>chassi_to_right_wheel</right_joint>

      <!-- kinematics -->
      <wheel_separation>0.329</wheel_separation>
      <wheel_diameter>0.1660</wheel_diameter>

      <!-- limits -->
      <max_linear_acceleration>0.5</max_linear_acceleration> 

      <topic>cmd_vel</topic> <!-- from <commant_topic> -->

      <odom_topic>odom</odom_topic> <!-- from <odometry_topic> -->
      <frame_id>odom</frame_id> <!-- from <odometry_frame> -->
      <child_frame_id>base_footprint</child_frame_id> <!-- from <robot_base_frame> -->
      <odom_publisher_frequency>30</odom_publisher_frequency> <!-- from <update_rate>-->

      <tf_topic>/tf</tf_topic> <!-- Short topic name for tf output -->

    </plugin>

    <!-- plugin: joint-state-publisher -->
    <plugin filename="gz-sim-joint-state-publisher-system"
      name="gz::sim::systems::JointStatePublisher">
      <topic>joint_states</topic> <!--from <ros><remapping> -->
      <joint_name>chassi_to_left_wheel</joint_name>
      <joint_name>chassi_to_right_wheel</joint_name>
    </plugin>

  </model>
</sdf>